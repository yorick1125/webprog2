1. write fail conditions in tests
2. handle failures in controller more correctly